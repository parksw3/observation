\documentclass{article}\usepackage[]{graphicx}\usepackage[]{color}
\usepackage[top=1in,left=1in, right = 1in, footskip=1in]{geometry}

\title{A note on observation processes in epidemic models}
\author{Sang Woo Park and Benjamin M. Bolker}

\usepackage{tabularx}

\usepackage{amsmath}
\usepackage{natbib}
\usepackage{hyperref}
\bibliographystyle{chicago}
\date{\today}

\usepackage{bm}

\usepackage{afterpage}
\usepackage{pdflscape}

\newcommand{\etal}{\textit{et al.}}

\newcommand{\comment}[3]{\textcolor{#1}{\textbf{[#2: }\textit{#3}\textbf{]}}}
\newcommand{\bmb}[1]{\comment{cyan}{BMB}{#1}}
\newcommand{\swp}[1]{\comment{magenta}{SWP}{#1}}
\newcommand{\citetapos}[1]{\citeauthor{#1}'s \citeyearpar{#1}}

\newcommand{\fref}[1]{Fig.~\ref{fig:#1}}
\begin{document}

\maketitle

\section*{Abstract}

Epidemic models provide valuable tools for understanding how a disease
spreads in a population. Many epidemic models focus on characterizing
the underlying transmission mechanism but make naive assumptions about
how infections are reported. In this note, we use a simple deterministic
Susceptible-Infected-Removed (SIR) model to compare two common assumptions 
about disease incidence reports: individuals can report their infection as soon as
they become infected or as soon as they recover. We show that making
wrong assumptions about the underlying observation processes can result
in biased estimates of the basic reproduction number and narrow confidence
intervals.

\section{Introduction}

Mechanistic analyses of epidemic time series allow us to infer the underlying 
transmission mechanism, estimate biologically relevant parameters, and 
predict the course of an outbreak \citep{breto2009time}. In order to make a 
precise and accurate inference, disease modelers have sought to build
more realistic process models. For example, the same London measles time 
series from the prevaccination era has been analyzed many times -- 
these models account for time-varying transmission rates \citep{fine1982measles}, 
realistic age structure \citep{schenzle1984age},
metapopulation structure \citep{xia2004measles}, continuous-time infection process 
\citep{cauchemez2008likelihood}, and extra-demographic variability \citep{he2009plug}. 

Despite the amount of effort put into developing \emph{better} process models, disease 
modelers often neglect details of the observation process associated with disease
case reports. Many disease models effectively assume that new cases are reported
instantaneously when an individual is infected (e.g., \cite{martinez2016differential, 
kennedy2018modeling, pons2018serotype}) or develops symptom (e.g., 
\cite{bhadra2011malaria, king2015avoidable}); 
some models (e.g., \cite{breto2009time, he2009plug, lin2016seasonality})
assume that infections are counted upon recovery (because diagnosed cases
are controlled and are effectively no longer infectious). 

Here, we use a simple Susceptible-Infected-Removed (SIR) model to study how 
assumptions about the underlying observation processes affect parameter estimates
of the SIR model. We show that making wrong assumptions about the timing of 
incidence reports can lead to biases in parameter estimates and narrow 
confidence intervals. 

\section{Methods}

The Susceptible-Infected-Removed (SIR) model describes how a disease spreads in a
homogeneous population:
\begin{equation}
\begin{aligned}
\frac{dS}{dt} &= - \beta S \frac{I}{N}\\
\frac{dI}{dt} &= \beta S \frac{I}{N} - \gamma I\\
\frac{dR}{dt} &= \gamma I,
\end{aligned}
\end{equation}
where $\beta$ is the contact rate per unit time, $\gamma$ is the recovery rate per unit time, 
and $N = S + I + R$ is the total population size. 
We define incidence at time $t$ as the number of newly infected
individuals that are infected between time $t- \Delta t$ and time $t$, where $\Delta t$ is
the reporting time step. We expect infected individuals to report their infection some time
after their infection; the number of reported cases defines the \emph{observed} incidence. 

For brevity, we consider two extreme cases: individuals instantaneously report
their infection when they become infected or when they recover. The observed incidence 
measured upon infection, $i_1(t)$, can be defined by the integral:
\begin{equation}
i_1(t) = \int_{t - \Delta t}^{t} \beta S \frac{I}{N} dt.
\end{equation}
Alternatively, we can keep track of cumulative incidence, $C$, by adding a 
new state variable described by $dC/dt = \beta S I/N$ and taking the difference between 
the two consecutive reporting periods: $i_1(t) = C(t) - C(t-\Delta t)$. Likewise, 
incidence measured upon recovery, $i_2(t)$, can be defined by the integral:
\begin{equation}
i_2(t) = \int_{t-\Delta t}^{t} \gamma I dt,
\end{equation}
or by the consecutive difference in the cumulative number of recovered cases:
$i_2(t) = R(t) - R(t - \Delta t)$.
Finally, we model under-reporting using a negative binomial distribution with a
mean either $\rho i_1(t)$ or $\rho i_2(t)$, where $\rho$ is the reporting rate, and
an over-dispersion parameter $\theta$. For convenience, we will refer to these two
negative binomial models as infection model and recovery model hereafter; 
likewise, we will refer to epidemic time series generated from these
negative binomial models with two different means ($\rho i_1(t)$ and $\rho i_2(t)$)
as infection time series and recovery time series.

In this study, we focus on estimating 5 parameters: the basic reproductive
number $\mathcal R_0 = \beta/\gamma$, mean infectious period $1/\gamma$, 
reporting rate $\rho$, an over dispersion parameter $\theta$ and the initial
proportion of the infected individuals $i_0$. Initial proportion of
susceptible individuals is assumed to be $1 - i_0$. The total population
size $N$ is assumed to be known.

\section{Results}

First, we compare the deterministic dynamics of incidence curves,
$i_1(t)$ and $i_2(t)$, in Figure 1. A lag in reporting time delays
the observed epidemic peak timing and reduces the size of the peak. However, 
these differences in the reporting time have small effect to the overall shape 
of the epidemic curve. In the presence of observation and process error, we 
might not expect to be able to distinguish between the two reporting processes
based on the time series alone. 

\begin{figure}[!t]
\includegraphics[width=\textwidth]{../figure/example.pdf}
\caption{
\textbf{A comparison of incidence measured at two different time points in infection.}
A deterministic SIR model is simulated using the following parameters: 
$\mathcal R_0 = 2$, $1/\gamma = 1$ time units, $N = 1 \times 10^5$, $i0 = 1 \times 10^{-4}$,
and $\Delta t = 0.1$ time units.
}
\end{figure}

Note that incidence is different from prevalence,
$I(t)$, which is defined as the number of \emph{currently} infected individuals;
the observed dynamics of incidence depend on the reporting time step (because the sum of 
true incidence is equal to the final size of an epidemic), whereas those of
prevalence do not. We expect the dynamics of incidence and prevalence to be similar only when
the reporting time step is equal to the disease generation time. While they are relatively
uncommon, some models do not make a clear distinction between a discrete-time observed 
variable and a continuous-time latent variable (Table 1).

\begin{table}
\centering
\begin{tabular}{l | c | c}
\hline
\textbf{Study} & \textbf{Disease} &  \textbf{Observed variables}\\
\hline
\cite{capistran2009parameter} & Respiratory syncytial virus & Number of hospital cases\\
\cite{hooker2010parameterizing} & Measles & Number of reported cases\\
\cite{eisenberg2013identifiability} & Cholera & Number of reported cases\\
\cite{yang2013stability} & Hand-foot-mouth disease & Number of reported cases\\
\cite{gonzalez2014fractional} & Influenza & Number of confirmed cases\\
\hline
\end{tabular}
\caption{
\textbf{List of studies that fit prevalence curves to incidence data.}
Incidence, defined as the number of new cases between two reporting periods, depends
on the reporting time step.
Prevalence, defined as the number of currently infected individuals, does not depend
on the reporting time step.
Some models do not make a clear distinction between these two quantities.
}
\end{table}

In order to understand how assumptions about the timing of case reporting affect 
parameter estimates of the SIR model, we simulate observed epidemic time series
(infection time series and recovery time series) 
100 times and fit both infection and recovery models to each 
time series. We compare the estimates of the basic reproductive number $\mathcal R_0$,
and its coverage probability, defined as the proportion of confidence intervals that
contain the true value (95\% confidence interval is expected to contain the true value
95\% of the time by definition). We summarize the results in Figure 2.

When we try to estimate all 5 parameters, fitting the recovery model to
infection time series underestimates the basic reproduction number and 
gives a slightly low coverage (Figure 2A). Fitting the infection model to recovery
time series slightly overestimates the basic reproduction number but gives 
good coverage. Fitting the correct models to their corresponding time series
gives unbiased estimates and good coverage.

\begin{figure}
\includegraphics[width=\textwidth]{../figure/compare_deterministic.pdf}
\caption{
\textbf{A comparison of incidence measured at two different time points in infection.}
We simulate infection time series and recovery time series 100 times using the 
following parameters:  
$\mathcal R_0 = 2$, $1/\gamma = 1$ time units, $N = 1 \times 10^5$, $i0 = 1 \times 10^{-4}$,
$\rho = 0.5$, $\theta = 10$, and $\Delta t = 0.1$ time units.
For each simulation, we fit the infection model and the recovery model by
(A) allowing for the mean infectious period to be estimated and (B) assuming
that the mean infectious period is known.
Coverage probabilities represent the proportion of confidence intervals
that contain the true value of the basic reproductive number ($\mathcal R_0$).
}
\end{figure}

Disease modelers often assume that the mean infectious period of a disease
is known and focus on estimating the basic reproduction number (e.g.,
\cite{hooker2010parameterizing, lin2016seasonality, pons2018serotype}). 
When we assume that the true value of the mean infectious period is known
and try to estimate the remaining 4 parameters of the SIR model, fitting the
wrong model results in a clearer bias and a much lower coverage (Figure 2B); however, 
bias changes direction (e.g., fitting the infection
model to recovery model overestimates the reproduction number instead). 

Differences in the direction of the bias can be explained by the estimates of the
exponential growth rate ($r = \beta - \gamma$) and the mean infectious period ($1/\gamma$).
In general, we expect delays in observation processes to make the observed epidemic 
time series last longer and have smaller peaks (Figure 1).
When we fit the recovery model to an infection time series, the model overestimates
the initial growth rate in order to match the bigger (and faster) epidemic peak of the 
infection time series. When the mean infectious period is fixed, higher growth rate
translates to higher basic reproduction number as we see in Figure 2B. When we allow
the mean infectious period to vary, the model still over estimates the growth rate but
also underestimates the mean infectious period (high $\gamma$), 
which decreases the overall estimate of the basic reproduction number.
Likewise, fitting the infection model to a recovery time series underestimates
the growth rate to match the smaller (and slower) epidemic peak; this 
underestimates the basic reproduction number when the mean infectious period is fixed. 
When we allow the mean infectious period to vary, we overestimate the mean infectious
period, which in turn increaseses the estimate of the basic reproduction number.

\section{Discussion}

Mathematical modeling of infectious disease outbreaks helps us understand 
how disease spreads in a population; however, many epidemic models make 
naive assumptions about how cases are reported. 
Here, we used a deterministic SIR model to show that 
making wrong assumptions about observational processes in epidemic models
can give biased estimates of the basic reproduction number and narrow
confidence intervals.

We assumed that newly infected cases are reported instantaneously when
individuals become infected or when they recover. Although neither of these
assumptions is realistic, they are broadly consistent with the assumptions
of other state-of-art epidemic models (see Introduction). 
More realistic models may distinguish reported and unreported
(i.e., identified and unidentified) cases by adding
new state variables \citep{browne2015modeling,webb2015model} 
or by modeling an explicit delay kernel in reporting time 
\citep{harris1990reporting, ferguson2001foot, ster2009epidemiological, 
birrell2011bayesian, funk2018real}.

While we only considered observation processes associated with incidence 
reporting in this study, it is equally as important to consider observation
processes in mortality reporting. In particular, many disease modelers have
tried to infer underlying transmission mechanisms from historical mortality 
data but assumed that individual deaths are recorded as soon as individuals die 
\citep{he2013inferring, didelot2017model, dean2018human}; this includes
\cite{kermack1927contribution} who approximated the reported \emph{number} of
deaths per week from plague with instantaneous death \emph{rates} ($dR/dt$).
This assumption does not account for the possibility 
that a delay in reporting of deaths can
change the shape of an epidemic curve: delayed reporting is expected to decrease
the size of the observed epidemic peak and delay the observed timing of the peak (Figure 1). 
Ignoring delays in reporting may affect conclusions about the underlying 
transmission mechanisms.

Our study shows that a seemingly negligible change in the assumptions of an epidemic
model can affect the inference of infectious disease transmission.
We caution disease modelers to be more mindful about their decisions in developing
epidemic models and the implications of their model assumptions.

\bibliography{observation}
\end{document}
